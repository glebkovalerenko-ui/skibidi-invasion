# GDD-Lite: Camera Agent: Toilet War

| Параметр | Описание |
| :--- | :--- |
| **Название** | Агент Камера: Битва Туалетов (Camera Agent: Toilet War) |
| **Жанр** | Vertical Scrolling Shooter (Shmup) / Arcade |
| **Платформа** | WebGL / HTML5 (Яндекс Игры) |
| **Аудитория** | Casual / Midcore, фанаты ретро-игр и мемной культуры |
| **Движок** | Custom Vanilla JS Engine (No frameworks) |
| **Версия** | 1.0.0 (Release Candidate) |

---

## 1. Концепция (High Concept)
Динамичный бесконечный космический шутер в стилистике VHS-кассет и ретро-консолей 80-х. Игрок управляет Агентом-Камерой, отражая бесконечные волны летающих инопланетных унитазов. Игра сочетает современное отзывчивое управление ("Hypercasual feel") с хардкорной эстетикой старой школы.

### Ключевые особенности (USP)
*   **CRT-симуляция:** Полноценный пост-процессинг эффект старого монитора (сканлайны, искажение, шум).
*   **Адаптивное управление:** Уникальная схема `Relative Drag` для мобильных устройств, обеспечивающая точность 1:1 без перекрытия обзора пальцем.
*   **Процедурные волны:** Враги движутся по сложным кривым Безье и сплайнам, создавая непредсказуемые паттерны атак.

---

## 2. Игровой процесс (Gameplay)

### Основной цикл (Core Loop)
1.  **Spawn:** Появление волны врагов по заданному паттерну.
2.  **Action:** Игрок уклоняется от снарядов и уничтожает врагов.
3.  **Reward:** Начисление очков (Score).
4.  **Progression:** С каждой волной растет сложность (скорость, частота стрельбы).
5.  **Fail State:** При потере 3 жизней наступает Game Over -> Показ Рекламы -> Рестарт.

### Управление
Система управления гибридная и автоматически подстраивается под устройство:

*   **Мобильные (Touch):**
    *   *Движение:* Относительное смещение (свайп в любой точке экрана сдвигает персонажа на то же расстояние).
    *   *Стрельба:* Автоматическая, пока палец на экране.
*   **ПК (Mouse/Keyboard):**
    *   *Мышь:* Абсолютное следование (персонаж привязан к курсору). ЛКМ — огонь.
    *   *Клавиатура:* Стрелки для движения, Пробел для огня.

### Механики
*   **Стрельба врагов:** Прицельная (в сторону игрока) и патерновая.
*   **Камикадзе:** Некоторые враги выходят из строя и пикируют на игрока.
*   **Неуязвимость:** После получения урона игрок получает 2 секунды неуязвимости (визуально отображается миганием).
*   **Коллизии:** Используется AABB (Axis-Aligned Bounding Box) с уменьшенным хитбоксом игрока (75% от спрайта) для более честного геймплея ("Forgiving Hitbox").

---

## 3. Интерфейс (UI/UX)

Весь интерфейс выполнен в диегетическом стиле (является частью игрового мира — операционной системы `CAMERA_OS`).

*   **Startup Screen:** Имитация загрузки BIOS/DOS. Требует первого клика для инициализации AudioContext (обход политик браузеров).
*   **Tutorial Screen:** Схематичное отображение управления, адаптированное под текущую платформу (ПК/Мобайл не различаются визуально, показываются обе схемы для универсальности).
*   **HUD:** Минималистичный. Жизни ("CAMERAS"), Текущий счет, Рекорд.
*   **Game Over:** Экран с результатами и призывом к рестарту.

---

## 4. Графика и Стилистика

*   **Спрайты:** Рендеры в стиле "Source Filmmaker" / 3D-пререндеринг, переведенные в 2D спрайты.
*   **Шейдеры (WebGL2):**
    *   *Curvature:* Искривление геометрии экрана.
    *   *Vignette:* Затемнение углов.
    *   *Scanlines:* Бегущие строки развертки.
    *   *Chromatic Aberration:* Смещение RGB каналов.
    *   *Bloom/Glow:* Имитация свечения люминофора.

---

## 5. Звук и Музыка

Реализован кастомный звуковой движок `AudioManager` на базе **Web Audio API**.

*   **Музыка:** Динамическое переключение треков.
    *   *Menu:* Агрессивный Phonk / Electronic.
    *   *Gameplay:* Ритмичный Synthwave (зацикленный плейлист).
*   **SFX:** Синтезированные ретро-звуки выстрелов и взрывов.
*   **Технические особенности:**
    *   Система "Anti-Audio-Drop": Использование тихого осциллятора для предотвращения засыпания AudioContext на iOS.
    *   Сохранение позиции трека при паузе/сворачивании.
    *   Автоматический мьют при уходе вкладки в фон (Visibility API).

---

## 6. Монетизация (Yandex Games)

*   **Interstitial Ads (Межстраничная реклама):** Показывается автоматически при событии `GameOver`, но не чаще таймера, установленного SDK.
*   **Интеграция SDK:**
    *   `ysdk.features.LoadingAPI.ready()` — отправляется после полной инициализации первого кадра.
    *   Корректная обработка звука при показе рекламы (Mute/Unmute).

---

## 7. Технические ограничения и Требования

*   **Разрешение:** Виртуальное разрешение 1024x1024, масштабируется через CSS `transform` / `width` с сохранением пропорций (Letterboxing).
*   **Ориентация:** Portrait (вертикальная), оптимизирована под мобильные телефоны, но играбельна на десктопе.
*   **Производительность:** Оптимизировано для 60 FPS на мобильных устройствах среднего сегмента. Используется Object Pooling для частиц и снарядов.